
# Empirical Results

```{r setup, include = FALSE}
source("misc/load_libraries.R")
knitr::opts_chunk$set(include = FALSE, echo = FALSE, message = FALSE, warning = FALSE, cache = FALSE)
```

```{r load data}
data <- read_rds("data/final/data.RDS")
```

```{r function to extract coefficients}
# because I'm only running log-linear regressions, I set it to return a string
# with a percentage rounded to 2 decimal places
extract_coef <- function(model, var) {
    coefs <- coef(model)
    result <- (coefs[var] * 100) %>% as.double() %>% round(2) %>% as.character()
    return(str_c(result, "%"))
}
```

```{r base reg model}
base_mdl <- felm(ln_price ~ treat | project_name, data = data)
summary(base_mdl)
```

```{r model with controls}
mdl_with_controls <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer | 
        project_name, data = data)
summary(mdl_with_controls)
```

```{r model with controls and year/month FE}
mdl_with_controls_ymfe <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer + year_sale + month_sale | 
        project_name, data = data)
summary(mdl_with_controls_ymfe)
```

Without any control variables, receiving the GM award with no changes in the property results in a price premium of `r extract_coef(base_mdl, "treat")`. Adding control variables like the floor area, type of sale and whether or not the buyer is a HDB owner drastically reduces the signalling effect of the GM award to `r extract_coef(mdl_with_controls, "treat")`. Adding year and month fixed effects reduces the effect even more, to `r extract_coef(mdl_with_controls_ymfe, "treat")`.

```{r basic regressions, include = TRUE, results = "asis"}
vars_to_keep <- names(coef(mdl_with_controls))
labels <- vars_to_keep %>% 
    str_replace_all("type_of_sale", "Type of Sale: ") %>% 
    str_replace_all("_", " ") %>% 
    str_to_title()
condo_fe <- c("Condo Level Fixed Effects", "Yes", "Yes", "Yes")
year_month_fe <- c("Year and Month Fixed Effects", "No", "No", "Yes")
stargazer(base_mdl, mdl_with_controls, mdl_with_controls_ymfe, 
          type = "latex", title = "Effects of GM Award on Price",
          keep = vars_to_keep, order = vars_to_keep, covariate.labels = labels,
          dep.var.labels = "Natural log of Price", header = FALSE,
          add.lines = list(condo_fe, year_month_fe), label = "mainresults")
```


```{r certified only model}
certified_mdl <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer + year_sale + month_sale | 
        project_name, data = data, subset = award == "Certified")
summary(certified_mdl)
```

```{r gold only model}
gold_mdl <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer + year_sale + month_sale | 
        project_name, data = data, subset = award == "Gold")
summary(gold_mdl)
```

```{r gold plus only model}
gold_plus_mdl <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer + year_sale + month_sale | 
        project_name, data = data, subset = award == "Gold Plus")
summary(gold_plus_mdl)
```

```{r platinum only model}
plat_mdl <- felm(
    ln_price ~ treat + area + type_of_sale + hdb_buyer + year_sale + month_sale | 
        project_name, data = data, subset = award == "Platinum")
summary(plat_mdl)
```


\newpage